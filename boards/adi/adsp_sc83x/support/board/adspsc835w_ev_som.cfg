# Analog Devices ADSPSC835W-EV-SOM
#
# Copyright (c) 2023 Analog Devices, Inc. All Rights Reserved.
# SPDX-License-Identifier: Apache-2.0
#
# This software is proprietary to Analog Devices, Inc. and its licensors.

set XTENSA_DAP enable

# Set flash parameters for IS25LP512M chip
set _FLASH_BASE 0x0

# Create Xtensa target first
source [find target/adspsc83x.cfg]

# Allocate space for flash algorithm
$_TARGETNAME_SFX configure -work-area-phys 0x20020000 -work-area-size 0x80000

# Flash size is automatically probed
flash bank $_CHIPNAME.flash adsp2183x $_FLASH_BASE 0 0 0 $_TARGETNAME_SFX

$_TARGETNAME_SFX configure -event reset-init {
	global _TARGETNAME_SFX
# switch current target to SHARC-FX to allow SPI flash to be programmed
	targets $_TARGETNAME_SFX
}

# define our board level memory here

# we use ranges because multiple flash device types can span
# the flash memory region from 0x60000000 - 0x80000000
# xSPI (Use ro for HyperFlash™, rw for HyperRAM™)

$_TARGETNAME_SFX xtensa xtmem	spi_range1			0x60000000	0x04000000	ro
# qSPI
$_TARGETNAME_SFX xtensa xtmem	spi_range2			0x70000000	0x04000000	ro

$_TARGETNAME_SFX xtensa xtmem	sram				0x80000000	0x20000000  rw

# only allow memory access based on our xtmem memory map
$_TARGETNAME_SFX xtensa set_permissive off